R := inputfromfile(sales1)
R1 := select(R, (time > 50) or (qty < 30))
R2 := project(R1, saleid, qty, pricerange)
R3 := avg(R1, qty)
R4 := sumgroup(R1, time, qty)
R5 := sumgroup(R1, qty, time, pricerange)
R6 := avggroup(R1, qty, pricerange)
outputtofile(R, R)
outputtofile(R1, R1)
outputtofile(R2, R2)
outputtofile(R3, R3)
outputtofile(R4, R4)
outputtofile(R5, R5)
outputtofile(R6, R6)
S := inputfromfile(sales2)
T := join(R, S, R.customerid = S.C)
T1 := join(R1, S, (R1.qty > S.Q) and (R1.saleid = S.saleid))
T2 := sort(T1, S_C)
T2prime := sort(T1, R1_time, S_C)
T3 := movavg(T2prime, R1_qty, 3)
T4 := movsum(T2prime, R1_qty, 5)
outputtofile(S, S)
outputtofile(T, T)
outputtofile(T1, T1)
outputtofile(T2, T2)
outputtofile(T2prime, T2prime)
outputtofile(T3, T3)
outputtofile(T4, T4)
Q1 := select(R, qty = 5)
Btree(R, qty)
Q2 := select(R, qty = 5)
Q3 := select(R, itemid = 7)
Hash(R,itemid)
Q4 := select(R, itemid = 7)
Q5 := concat(Q4, Q2)
outputtofile(Q1, Q1)
outputtofile(Q2, Q2)
outputtofile(Q3, Q3)
outputtofile(Q4, Q4)
outputtofile(Q5, Q5)
outputtofile(R, R)
outputtofile(R1, R1)
outputtofile(R2, R2)
outputtofile(R3, R3)
outputtofile(R4, R4)
outputtofile(R5, R5)
outputtofile(R6, R6)
outputtofile(S, S)
outputtofile(T, T)
outputtofile(T1, T1)
outputtofile(T2, T2)
outputtofile(T2prime, T2prime)
outputtofile(T3, T3)
outputtofile(T4, T4)
outputtofile(Q1, Q1)
outputtofile(Q2, Q2)
outputtofile(Q3, Q3)
outputtofile(Q4, Q4)
outputtofile(Q5, Q5)